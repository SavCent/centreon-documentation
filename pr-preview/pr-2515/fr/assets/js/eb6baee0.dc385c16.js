"use strict";(self.webpackChunkcentreon_docs=self.webpackChunkcentreon_docs||[]).push([[52046],{18392:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>d,default:()=>k,frontMatter:()=>u,metadata:()=>c,toc:()=>m});t(667294);var r=t(603905),a=t(451715),s=t(907626);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){return n=null!=n?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):function(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})),e}function l(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)t=s[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}const u={id:"upgrade-from-centreon-failover",title:"Passage de Centreon-Failover \xe0 Centreon-HA"},d=void 0,c={unversionedId:"upgrade/centreon-ha/upgrade-from-centreon-failover",id:"version-22.10/upgrade/centreon-ha/upgrade-from-centreon-failover",title:"Passage de Centreon-Failover \xe0 Centreon-HA",description:"Conditions pr\xe9alables",source:"@site/i18n/fr/docusaurus-plugin-content-docs/version-22.10/upgrade/centreon-ha/upgrade-from-centreon-failover.md",sourceDirName:"upgrade/centreon-ha",slug:"/upgrade/centreon-ha/upgrade-from-centreon-failover",permalink:"/fr/docs/22.10/upgrade/centreon-ha/upgrade-from-centreon-failover",draft:!1,editUrl:"https://github.com/centreon/centreon-documentation/edit/staging/i18n/fr/docusaurus-plugin-content-docs/version-22.10/upgrade/centreon-ha/upgrade-from-centreon-failover.md",tags:[],version:"22.10",lastUpdatedAt:1690809822,formattedLastUpdatedAt:"31 juil. 2023",frontMatter:{id:"upgrade-from-centreon-failover",title:"Passage de Centreon-Failover \xe0 Centreon-HA"},sidebar:"version-22.10/docs",previous:{title:"Mont\xe9e de version de Centreon HA depuis Centreon 22.04",permalink:"/fr/docs/22.10/upgrade/centreon-ha/upgrade-centreon-ha-from-22-04"},next:{title:"Mettre \xe0 jour MariaDB",permalink:"/fr/docs/22.10/upgrade/upgrade-mariadb"}},p={},m=[{value:"Conditions pr\xe9alables",id:"conditions-pr\xe9alables",level:2},{value:"Compr\xe9hension",id:"compr\xe9hension",level:3},{value:"Champ d&#39;application",id:"champ-dapplication",level:3},{value:"Destruction de l&#39;ancien cluster",id:"destruction-de-lancien-cluster",level:2},{value:"Mise \xe0 jour de MariaDB",id:"mise-\xe0-jour-de-mariadb",level:2},{value:"Cr\xe9er le nouveau cluster",id:"cr\xe9er-le-nouveau-cluster",level:2},{value:"Finalisation de la mise \xe0 niveau",id:"finalisation-de-la-mise-\xe0-niveau",level:3}],f={toc:m},v="wrapper";function k(e){var{components:n}=e,t=l(e,["components"]);return(0,r.kt)(v,i(function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){o(e,n,t[n])}))}return e}({},f,t),{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"conditions-pr\xe9alables"},"Conditions pr\xe9alables"),(0,r.kt)("h3",{id:"compr\xe9hension"},"Compr\xe9hension"),(0,r.kt)("p",null,"Cette proc\xe9dure est r\xe9serv\xe9e aux utilisateurs avanc\xe9s. Lisez-la enti\xe8rement avant de commencer toute op\xe9ration.\nAssurez-vous de bien comprendre l'ensemble de la proc\xe9dure afin de minimiser les interruptions de service lorsque\nle moment de le faire sur les serveurs de production viendra."),(0,r.kt)("h3",{id:"champ-dapplication"},"Champ d'application"),(0,r.kt)("p",null,"Cette proc\xe9dure vise \xe0 fournir un guide d\xe9taill\xe9 sur la fa\xe7on de mettre \xe0 niveau une version de Centreon install\xe9e en version < 20.04 avec\nla solution centreon-failover d\xe9ploy\xe9e. "),(0,r.kt)("p",null,"Si vous n'avez jamais travaill\xe9 avec l'\xe9quipe des services professionnels de Centreon ou avec l'un de nos partenaires, vous n'\xeates probablement pas concern\xe9 par le contenu ci-dessous.\nci-dessous."),(0,r.kt)("p",null,"Veuillez toujours ouvrir un ticket de support pour vous assurer que votre plateforme est conforme au processus de mise \xe0 niveau d\xe9crit ici."),(0,r.kt)("h2",{id:"destruction-de-lancien-cluster"},"Destruction de l'ancien cluster"),(0,r.kt)("p",null,"Pour migrer de centreon-failover vers centreon-ha, il est n\xe9cessaire de d\xe9truire le Cluster existant. Sachez que l'interface\nWeb UI ne sera pas disponible pendant ce processus."),(0,r.kt)("p",null,"Connectez-vous par SSH \xe0 un n\u0153ud du Cluster pour ex\xe9cuter la commande suivante :"),(0,r.kt)("p",null,"D\xe9sactiver les ressources : "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"pcs resource disable ms_mysql\npcs resource disable centreon\npcs resource unmanage centreon\npcs resource unmanage ms_mysql\n")),(0,r.kt)("p",null,"D\xe9truisez le cluster :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"pcs cluster destroy\n")),(0,r.kt)("p",null,"\xc0 cette \xe9tape, aucun des processus g\xe9r\xe9s par le cluster ne doit s'ex\xe9cuter sur aucun n\u0153ud."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Attention : ")," Assurez-vous de v\xe9rifier \xe0 la fois le serveur central et le serveur de base de donn\xe9es. ")),(0,r.kt)("h2",{id:"mise-\xe0-jour-de-mariadb"},"Mise \xe0 jour de MariaDB"),(0,r.kt)("p",null,"Centreon >= 21.10 est livr\xe9 avec une compatibilit\xe9 avec MariaDB 10.5."),(0,r.kt)("p",null,"Mettez \xe0 niveau les deux n\u0153uds de base de donn\xe9es en suivant la ",(0,r.kt)("a",{parentName:"p",href:"/fr/docs/22.10/upgrade/upgrade-from-19-10#Mont%C3%A9e-de-version-du-serveur-MariaDB"},"proc\xe9dure officielle de mise \xe0 niveau de MariaDB"),". "),(0,r.kt)("p",null,"Une fois que les deux n\u0153uds ex\xe9cutent la version 10.5 de MariaDB, arr\xeatez les processus mysql/mariadb. "),(0,r.kt)("p",null,"##Mettre \xe0 niveau les paquets Centreon "),(0,r.kt)("p",null,"Suivez ces \xe9tapes sur chaque n\u0153ud Centreon."),(0,r.kt)("p",null,"Si vous mettez \xe0 jour depuis la version 19.10 : "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/fr/docs/22.10/upgrade/upgrade-from-19-10#Mettre-%C3%A0-jour-le-d%C3%A9p%C3%B4t-Centreon"},"Mettez \xe0 jour vos r\xe9f\xe9rentiels"),". Egalement ceux des modules de l'\xe9dition Business s'ils sont install\xe9s."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/fr/docs/22.10/upgrade/upgrade-from-19-10#Mont%C3%A9e-de-version-de-la-solution-Centreon"},"Mettre \xe0 jour vos paquets")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/fr/docs/22.10/upgrade/upgrade-from-19-10#Actions-compl%C3%A9mentaires"},"Prendre les mesures suppl\xe9mentaires requises"))),(0,r.kt)("p",null,"Si vous effectuez une mise \xe0 niveau depuis la version 19.04 : "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/fr/docs/22.10/upgrade/upgrade-from-19-04#Mise-%C3%A0-jour-des-d%C3%A9p%C3%B4ts"},"Mettre \xe0 jour vos r\xe9f\xe9rentiels"),". Egalement ceux des modules Business Edition s'ils sont install\xe9s."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/fr/docs/22.10/upgrade/upgrade-from-19-04#Mont%C3%A9e-de-version-de-la-solution-Centreon"},"Mettre \xe0 jour vos paquets")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/fr/docs/22.10/upgrade/upgrade-from-19-04#Actions-compl%C3%A9mentaires"},"Prendre les mesures suppl\xe9mentaires n\xe9cessaires"))),(0,r.kt)("p",null,"Arr\xeatez le processus apache apr\xe8s ces op\xe9rations et v\xe9rifiez \xe0 nouveau qu'aucun des processus g\xe9r\xe9s par le cluster n'est en cours d'ex\xe9cution.\nprocessus g\xe9r\xe9 par le cluster est en cours d'ex\xe9cution."),(0,r.kt)("h2",{id:"cr\xe9er-le-nouveau-cluster"},"Cr\xe9er le nouveau cluster"),(0,r.kt)("p",null,"Selon l'architecture de votre Cluster, la proc\xe9dure de cr\xe9ation du cluster est diff\xe9rente. "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Si le serveur web et les bases de donn\xe9es sont ex\xe9cut\xe9s sur le m\xeame noeud, suivez ce ",(0,r.kt)("a",{parentName:"li",href:"/fr/docs/22.10/installation/installation-of-centreon-ha/installation-2-nodes#Mise-en-place-du-cluster-Centreon"},"guide d'installation de HA 2 noeuds")),(0,r.kt)("li",{parentName:"ul"},"Si les bases de donn\xe9es sont ex\xe9cut\xe9es sur un serveur d\xe9di\xe9, suivez ce ",(0,r.kt)("a",{parentName:"li",href:"/fr/docs/22.10/installation/installation-of-centreon-ha/installation-4-nodes#Mise-en-place-du-cluster-Centreon"},"guide d'installation de HA 4 n\u0153uds"))),(0,r.kt)("p",null,"Avant de passer aux \xe9tapes suivantes, assurez-vous que toutes les ressources fonctionnent sans probl\xe8me et qu'aucune action n'a \xe9chou\xe9."),(0,r.kt)("p",null,"Si un probl\xe8me survient \xe0 cette \xe9tape, assurez-vous que les conditions pr\xe9alables suivantes sont remplies : "),(0,r.kt)(a.Z,{groupId:"sync",mdxType:"Tabs"},(0,r.kt)(s.Z,{value:"HA 2 nodes",label:"HA 2 nodes",mdxType:"TabItem"},(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/fr/docs/22.10/installation/installation-of-centreon-ha/installation-2-nodes#%C3%89changes-de-clefs-SSH"},"\xc9change de cl\xe9s SSH"),", Centreon-HA est plus s\xe9curis\xe9 car il ne n\xe9cessite pas de privil\xe8ges root."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/fr/docs/22.10/installation/installation-of-centreon-ha/installation-2-nodes#Cr%C3%A9ation-du-compte-centreon"},"Informations d'identification et privil\xe8ges de la base de donn\xe9es"),", comme ci-dessus, le compte SQL root n'est plus n\xe9cessaire."))),(0,r.kt)(s.Z,{value:"HA 4 nodes",label:"HA 4 nodes",mdxType:"TabItem"},(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/fr/docs/22.10/installation/installation-of-centreon-ha/installation-4-nodes#%C3%89changes-de-clefs-SSH"},"\xc9change de cl\xe9s SSH"),", Centreon-HA est plus s\xe9curis\xe9 car il ne n\xe9cessite pas de privil\xe8ges root."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/fr/docs/22.10/installation/installation-of-centreon-ha/installation-4-nodes#Cr%C3%A9ation-du-compte-centreon"},"Informations d'identification et privil\xe8ges de la base de donn\xe9es"),", comme ci-dessus, le compte SQL root n'est plus n\xe9cessaire.")))),(0,r.kt)("p",null,"Une fois que les cl\xe9s SSH de centreon et de mysql ont \xe9t\xe9 \xe9chang\xe9es, vous pouvez supprimer les cl\xe9s publiques SSH de root de /root/.ssh/authorized_keys."),(0,r.kt)("h3",{id:"finalisation-de-la-mise-\xe0-niveau"},"Finalisation de la mise \xe0 niveau"),(0,r.kt)("p",null,"Tout d'abord, effectuez les \xe9tapes de l'assistant Web pour terminer le processus de mise \xe0 niveau de Central :"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Si vous effectuez une mise \xe0 niveau depuis la version 19.10, suivez ce ",(0,r.kt)("a",{parentName:"li",href:"/fr/docs/22.10/upgrade/upgrade-from-19-10#Finalisation-de-la-mise-%C3%A0-jour"},"chapitre"),"."),(0,r.kt)("li",{parentName:"ul"},"Si vous effectuez une mise \xe0 niveau depuis la version 19.04, suivez ce ",(0,r.kt)("a",{parentName:"li",href:"/fr/docs/22.10/upgrade/upgrade-from-19-04#Finalisation-de-la-mise-%C3%A0-jour"},"chapitre"),".")),(0,r.kt)(a.Z,{groupId:"sync",mdxType:"Tabs"},(0,r.kt)(s.Z,{value:"HA 2 nodes",label:"HA 2 nodes",mdxType:"TabItem"},(0,r.kt)("p",null,"Ensuite, modifiez la commande de rechargement de Centreon-Broker de votre serveur central dans 'Configuration > Pollers' comme d\xe9crit ",(0,r.kt)("a",{parentName:"p",href:"/fr/docs/22.10/installation/installation-of-centreon-ha/installation-2-nodes#Modification-de-la-commande-de-rechargement-de-%60cbd%60"},"ici"),".")),(0,r.kt)(s.Z,{value:"HA 4 nodes",label:"HA 4 nodes",mdxType:"TabItem"},(0,r.kt)("p",null,"Ensuite, modifiez la commande de rechargement de Centreon-Broker de votre serveur central dans 'Configuration > Pollers' comme d\xe9crit ",(0,r.kt)("a",{parentName:"p",href:"/fr/docs/22.10/installation/installation-of-centreon-ha/installation-4-nodes#Modification-de-la-commande-de-rechargement-de-%60cbd%60"},"ici"),"."))),(0,r.kt)("p",null,"Enfin, mettez \xe0 jour votre/vos poller(s) comme d\xe9crit ",(0,r.kt)("a",{parentName:"p",href:"/fr/docs/22.10/upgrade/upgrade-from-19-04#Mont%C3%A9e-de-version-des-Pollers"},"ici")))}k.isMDXComponent=!0}}]);