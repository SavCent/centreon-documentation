"use strict";(self.webpackChunkcentreon_docs=self.webpackChunkcentreon_docs||[]).push([[72968],{603905:(e,r,t)=>{t.d(r,{Zo:()=>c,kt:()=>g});var n=t(667294);function a(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function o(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function l(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?o(Object(t),!0).forEach((function(r){a(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function s(e,r){if(null==e)return{};var t,n,a=function(e,r){if(null==e)return{};var t,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)t=o[n],r.indexOf(t)>=0||(a[t]=e[t]);return a}(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)t=o[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var i=n.createContext({}),u=function(e){var r=n.useContext(i),t=r;return e&&(t="function"==typeof e?e(r):l(l({},r),e)),t},c=function(e){var r=u(e.components);return n.createElement(i.Provider,{value:r},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var r=e.children;return n.createElement(n.Fragment,{},r)}},m=n.forwardRef((function(e,r){var t=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=u(t),m=a,g=p["".concat(i,".").concat(m)]||p[m]||d[m]||o;return t?n.createElement(g,l(l({ref:r},c),{},{components:t})):n.createElement(g,l({ref:r},c))}));function g(e,r){var t=arguments,a=r&&r.mdxType;if("string"==typeof e||a){var o=t.length,l=new Array(o);l[0]=m;var s={};for(var i in r)hasOwnProperty.call(r,i)&&(s[i]=r[i]);s.originalType=e,s[p]="string"==typeof e?e:a,l[1]=s;for(var u=2;u<o;u++)l[u]=t[u];return n.createElement.apply(null,l)}return n.createElement.apply(null,t)}m.displayName="MDXCreateElement"},300141:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>c,contentTitle:()=>i,default:()=>g,frontMatter:()=>s,metadata:()=>u,toc:()=>p});t(667294);var n=t(603905);function a(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function o(e,r){return r=null!=r?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):function(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})),e}function l(e,r){if(null==e)return{};var t,n,a=function(e,r){if(null==e)return{};var t,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)t=o[n],r.indexOf(t)>=0||(a[t]=e[t]);return a}(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)t=o[n],r.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}const s={id:"backup-poller",title:"Sauvegarder et restaurer vos collecteurs"},i=void 0,u={unversionedId:"administration/backup-poller",id:"version-23.04/administration/backup-poller",title:"Sauvegarder et restaurer vos collecteurs",description:"Cas n\xb01 : Faire des sauvegardes pour pouvoir installer un nouveau collecteur \xe0 partir de z\xe9ro",source:"@site/i18n/fr/docusaurus-plugin-content-docs/version-23.04/administration/backup-poller.md",sourceDirName:"administration",slug:"/administration/backup-poller",permalink:"/centreon-documentation/pr-preview/staging/pr-2702/fr/docs/administration/backup-poller",draft:!1,editUrl:"https://github.com/centreon/centreon-documentation/edit/staging/i18n/fr/docusaurus-plugin-content-docs/version-23.04/administration/backup-poller.md",tags:[],version:"23.04",lastUpdatedAt:1696607991,formattedLastUpdatedAt:"6 oct. 2023",frontMatter:{id:"backup-poller",title:"Sauvegarder et restaurer vos collecteurs"},sidebar:"version-23.04/docs",previous:{title:"Sauvegarder et restaurer votre serveur central",permalink:"/centreon-documentation/pr-preview/staging/pr-2702/fr/docs/administration/backup"},next:{title:"Base de connaissance",permalink:"/centreon-documentation/pr-preview/staging/pr-2702/fr/docs/administration/knowledge-base"}},c={},p=[{value:"Cas n\xb01 : Faire des sauvegardes pour pouvoir installer un nouveau collecteur \xe0 partir de z\xe9ro",id:"cas-n1--faire-des-sauvegardes-pour-pouvoir-installer-un-nouveau-collecteur-\xe0-partir-de-z\xe9ro",level:2},{value:"Donn\xe9es \xe0 sauvegarder sur le collecteur actif",id:"donn\xe9es-\xe0-sauvegarder-sur-le-collecteur-actif",level:3},{value:"Basculer vers le nouveau collecteur",id:"basculer-vers-le-nouveau-collecteur",level:3},{value:"Cas n\xb02: Collecteur de secours",id:"cas-n2-collecteur-de-secours",level:2},{value:"Donn\xe9es \xe0 synchroniser",id:"donn\xe9es-\xe0-synchroniser",level:3},{value:"Basculer vers le collecteur de secours",id:"basculer-vers-le-collecteur-de-secours",level:3},{value:"Cas n\xb03 : Snapshots de machines virtuelles",id:"cas-n3--snapshots-de-machines-virtuelles",level:2}],d={toc:p},m="wrapper";function g(e){var{components:r}=e,t=l(e,["components"]);return(0,n.kt)(m,o(function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){a(e,r,t[r])}))}return e}({},d,t),{components:r,mdxType:"MDXLayout"}),(0,n.kt)("h2",{id:"cas-n1--faire-des-sauvegardes-pour-pouvoir-installer-un-nouveau-collecteur-\xe0-partir-de-z\xe9ro"},"Cas n\xb01 : Faire des sauvegardes pour pouvoir installer un nouveau collecteur \xe0 partir de z\xe9ro"),(0,n.kt)("h3",{id:"donn\xe9es-\xe0-sauvegarder-sur-le-collecteur-actif"},"Donn\xe9es \xe0 sauvegarder sur le collecteur actif"),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"Dans cette section, nous partons du principe que ",(0,n.kt)("a",{parentName:"p",href:"/centreon-documentation/pr-preview/staging/pr-2702/fr/docs/monitoring/pluginpacks#installation-automatique"},"l'installation automatique des plugins Centreon")," est activ\xe9e.")),(0,n.kt)("p",null,"Sauvegardez les \xe9l\xe9ments suivants afin d'\xeatre en mesure de compl\xe8tement reconstruire votre collecteur en cas de probl\xe8me."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Plugins personnalis\xe9s (par exemple: plugins de la communaut\xe9, ou d\xe9veloppements sp\xe9cifiques)"),(0,n.kt)("li",{parentName:"ul"},"Si vous utilisez le connecteur ",(0,n.kt)("strong",{parentName:"li"},"centreon-vmware-daemon")," (installation et configuration): sauvegardez ",(0,n.kt)("strong",{parentName:"li"},"/etc/centreon/centreon_vmware.pm")),(0,n.kt)("li",{parentName:"ul"},"Si vous utilisez le connecteur ",(0,n.kt)("strong",{parentName:"li"},"centreon-as400")," (installation et configuration): sauvegardez ",(0,n.kt)("strong",{parentName:"li"},"/etc/centreon-as400/")),(0,n.kt)("li",{parentName:"ul"},"Synchronisez les fichiers suivants r\xe9guli\xe8rement (par exemple avec la commande ",(0,n.kt)("strong",{parentName:"li"},"rsync"),") :",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"/var/log/centreon-engine/retention.dat")," (jusqu'\xe0 toutes les 15 minutes) pour garder les acquittements, les plages de maintenance et les statuts."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"/var/lib/centreon/centplugins/","*")," (jusqu'\xe0 toutes les 5 minutes) pour garder le cache des plugins."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"/etc/centreon-gorgone/config.d/","*")," (une seule fois) pour garder les informations de connexion au serveur central."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"/var/lib/centreon-gorgone/.keys/","*")," (une seule fois) pour garder l'empreinte pour l'authentification ZeroMQ.")))),(0,n.kt)("h3",{id:"basculer-vers-le-nouveau-collecteur"},"Basculer vers le nouveau collecteur"),(0,n.kt)("p",null,"Si votre collecteur devient hors d'usage, ",(0,n.kt)("a",{parentName:"p",href:"/centreon-documentation/pr-preview/staging/pr-2702/fr/docs/installation/installation-of-a-poller/using-packages"},"installez un nouveau collecteur"),", dans la version correspondant \xe0 votre plateforme, rattachez-le au serveur central, puis restaurez tous les \xe9l\xe9ments list\xe9s ci-dessus."),(0,n.kt)("p",null,"Si vous n'aviez pas sauvegard\xe9 le fichier ",(0,n.kt)("strong",{parentName:"p"},"/var/lib/centreon-gorgone/.keys/","*"),", vous devrez changer l'empreinte du collecteur dans la configuration du serveur central. Voir ",(0,n.kt)("a",{parentName:"p",href:"https://thewatch.centreon.com/troubleshooting-41/poller-does-not-work-after-migration-or-reinstallation-fingerprint-changed-for-target-1177"},"l'article suivant")," sur notre plateforme communautaire The Watch."),(0,n.kt)("h2",{id:"cas-n2-collecteur-de-secours"},"Cas n\xb02: Collecteur de secours"),(0,n.kt)("p",null,"Une autre fa\xe7on de se pr\xe9parer \xe0 un probl\xe8me est d'avoir un collecteur de secours sur lequel vous synchronisez les donn\xe9es de votre collecteur actif. Si votre collecteur devient hors d'usage, il vous suffira de basculer sur le collecteur de secours."),(0,n.kt)("h3",{id:"donn\xe9es-\xe0-synchroniser"},"Donn\xe9es \xe0 synchroniser"),(0,n.kt)("p",null,"Installez et configurez les m\xeames \xe9l\xe9ments sur votre collecteur de secours que sur votre collecteur actif, et synchronisez les donn\xe9es ",(0,n.kt)("a",{parentName:"p",href:"#donn%C3%A9es-%C3%A0-sauvegarder-sur-le-collecteur-actif"},"comme d\xe9crit ici"),"."),(0,n.kt)("h3",{id:"basculer-vers-le-collecteur-de-secours"},"Basculer vers le collecteur de secours"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"D\xe9marrez le collecteur de secours si celui-ci est arr\xeat\xe9.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Changez la configuration r\xe9seau du collecteur de secours afin de lui attribuer l'adresse IP de l'ancien collecteur.")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Red\xe9marrez ",(0,n.kt)("strong",{parentName:"p"},"gorgoned")," d'abord sur le collecteur, puis sur le central."),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl restart gorgoned\n"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"V\xe9rifiez que le log de Gorgone ne pr\xe9sente pas d'erreurs de communication."),(0,n.kt)("pre",{parentName:"li"},(0,n.kt)("code",{parentName:"pre",className:"language-shell"},"tail -F /var/log/centreon-gorgone/gorgoned.log | grep ERROR\n"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",{parentName:"p",href:"/centreon-documentation/pr-preview/staging/pr-2702/fr/docs/monitoring/monitoring-servers/deploying-a-configuration"},"D\xe9ployez la configuration")," pour le collecteur, en utilisant la m\xe9thode ",(0,n.kt)("strong",{parentName:"p"},"Restart")," (dans la liste ",(0,n.kt)("strong",{parentName:"p"},"Red\xe9marrer l'ordonnanceur"),").")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"Si vous n'aviez pas sauvegard\xe9 le fichier ",(0,n.kt)("strong",{parentName:"p"},"/var/lib/centreon-gorgone/.keys/","*"),", vous devrez changer l'empreinte du collecteur dans la configuration du serveur central. Voir ",(0,n.kt)("a",{parentName:"p",href:"https://thewatch.centreon.com/troubleshooting-41/poller-does-not-work-after-migration-or-reinstallation-fingerprint-changed-for-target-1177"},"l'article suivant")," sur notre plateforme communautaire The Watch."))),(0,n.kt)("h2",{id:"cas-n3--snapshots-de-machines-virtuelles"},"Cas n\xb03 : Snapshots de machines virtuelles"),(0,n.kt)("p",null,"Si votre collecteur tourne sur une VM, faites des snapshots r\xe9guliers de votre collecteur. Si un probl\xe8me survient, restaurez le snapshot comme pour n'importe quelle machine virtuelle."))}g.isMDXComponent=!0}}]);